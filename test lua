
menu.add_key_bind('Legit Anti-Aim')
local cache = false
local state = false
client.add_callback('create_move', function()
    local local_player = entitylist.get_local_player()
    if not local_player then return end

    local key = menu.get_key_bind_state('Legit Anti-Aim')

    local isDefusing = local_player:get_prop_bool('CCSPlayer', 'm_bIsDefusing')
    local isGrabbing = local_player:get_prop_bool('CCSPlayer', 'm_bIsGrabbingHostage')

    if key then
        if isDefusing or isGrabbing then
            console.execute('+use')
        else
            console.execute('-use')
        end
        if not cache then
            cache_value = {
                default_yaw = menu.get_int('anti_aim.yaw_offset'),
            }
            menu.set_int('anti_aim.yaw_offset', 180)
            cache = true
        end
        state = true
    else
        if cache then
            if state then
                console.execute('-use')
                state = false
            end
            console.execute('bind e +use')
            menu.set_int('anti_aim.yaw_offset', cache_value.default_yaw)
            print(tostring(cache_value.default_yaw))
            cache = false
        end
    end
end)
